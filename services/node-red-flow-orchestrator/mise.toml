[env]
NODE_RED_DIR = "~/.node-red"
FLOWS_DIR = "{{config_root}}/flows"
SCRIPTS_DIR = "{{config_root}}/scripts"

[tasks.deploy-flows]
description = "Deploy flows to Node-RED runtime and restart"
run = ".mise/scripts/deploy_flows.sh"

[tasks.logs]
description = "Tail Node-RED logs"
run = "pm2 logs node-red"

[tasks.status]
description = "Show Node-RED PM2 status"
run = "pm2 info node-red"

[tasks.restart]
description = "Deploy flows and restart Node-RED"
depends = ["deploy-flows"]
run = "echo 'Node-RED restarted with latest flows.'"

[tasks.stop]
description = "Stop Node-RED"
run = "pm2 stop node-red"

[tasks.start]
description = "Start Node-RED"
run = "pm2 start ~/.node-red/ecosystem.config.js"

[tasks.setup-scripts]
description = "Set up Python venv for helper scripts"
run = ".mise/scripts/setup_scripts.sh"

[tasks.generate-password-hash]
description = "Generate bcrypt hash for Node-RED admin password"
run = ".mise/scripts/generate_password_hash.sh"